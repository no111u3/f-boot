/* at45x writing data */extern unsigned at45_write(unsigned lba, const void *ptr, unsigned len) {    const unsigned char *ptr8_r = ptr;	unsigned page, pg_n, z0, z1, id = 1;    /* check data address and size */    page = lba / AT45_PAGE_SIZE;    z0 = lba % AT45_PAGE_SIZE;        pg_n = len / AT45_PAGE_SIZE;    z1 = len % AT45_PAGE_SIZE;    	if (z0 != 0)		return -1;	if (z1 != 0)		return -1;	util_printf("Writing page = 0x%x, count = 0x%x\n",			page, pg_n);	while (pg_n--) {		at45_buffer_fill(id, ptr8_r);                at45_wait_rdy();        		at45_page_write(id, lba);		id = (id == 1) ? 2 : 1;		ptr8_r += AT45_PAGE_SIZE;        lba += AT45_PAGE_SIZE;	}	at45_wait_rdy();	return 0;}/* at45x writing data through buffer */extern unsigned at45_write_through(unsigned lba, const void *ptr, unsigned len) {    const unsigned char *ptr8_r = ptr;	unsigned page, pg_n, z0, z1, id = 1;	/* check data address and size */    page = lba / AT45_PAGE_SIZE;    z0 = lba % AT45_PAGE_SIZE;        pg_n = len / AT45_PAGE_SIZE;    z1 = len % AT45_PAGE_SIZE;    	if (z0 != 0)		return -1;	if (z1 != 0)		return -1;	util_printf("Writing page = 0x%x, count = 0x%x\n",			page, pg_n);	while (pg_n--) {        at45_buffer_fill(id, ptr8_r);                at45_wait_rdy();    		at45_page_write_through(id, lba);		id = (id == 1) ? 2 : 1;		ptr8_r += AT45_PAGE_SIZE;		lba += AT45_PAGE_SIZE;	}	at45_wait_rdy();	return 0;}